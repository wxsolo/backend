# Generated by CoffeeScript 1.6.3
mongoose = require '../lib/mongoose'
userSchema = new mongoose.Schema
  name:
    type: String
    index: true
    unique: true
  email:
    type: String
    index: true
    unique: true
  password: String
module.exports = User = mongoose.model 'User', userSchema
# save user
User.save = (info,next)->
  user = new User
  user.register info,next
User::register = (info,next)->
  self = @
  self.name = info.name
  self.email = info.email
  self.password = info.password
  self.save()
  next null,info
# check user
User.get = (user,next)->
  next 201 if not user.email?
  User.findOne {email:user.email},(err,dbUser)->
    return next err if err
    if not dbUser?
      next err,null
    else
      next err,dbUser
